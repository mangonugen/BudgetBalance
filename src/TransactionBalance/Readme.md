Some of this code is from this site below.
http://www.codeproject.com/Articles/808213/Developing-a-Large-Scale-Application-with-a-Single